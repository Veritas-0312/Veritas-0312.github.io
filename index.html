<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Satyavrat Yadav | Portfolio</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=VT323&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --green: #00ff41;
    --green-dim: #00b32c;
    --yellow: #f0c040;
    --pink: #ff79c6;
    --cyan: #8be9fd;
    --red: #ff5555;
    --white: #f8f8f2;
    --bg: #0d0d0d;
    --scanline: rgba(0,255,65,0.03);
  }

  body {
    background: var(--bg);
    color: var(--green);
    font-family: 'Share Tech Mono', monospace;
    font-size: 15px;
    line-height: 1.6;
    overflow: hidden;
    height: 100vh;
    width: 100vw;
  }

  /* CRT scanline effect */
  body::before {
    content: '';
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      var(--scanline) 2px,
      var(--scanline) 4px
    );
    pointer-events: none;
    z-index: 9999;
  }

  /* CRT vignette */
  body::after {
    content: '';
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: radial-gradient(ellipse at center, transparent 60%, rgba(0,0,0,0.8) 100%);
    pointer-events: none;
    z-index: 9998;
  }

  /* ========== BOOT SCREEN ========== */
  #boot-screen {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: var(--bg);
    z-index: 1000;
    padding: 20px;
    overflow: hidden;
  }

  #boot-lines {
    white-space: pre;
    font-size: 13px;
  }

  .boot-line {
    display: block;
    opacity: 0;
    animation: bootAppear 0.05s forwards;
  }

  .boot-ok { color: var(--green); }
  .boot-warn { color: var(--yellow); }
  .boot-info { color: var(--cyan); }
  .boot-err { color: var(--red); }

  @keyframes bootAppear {
    to { opacity: 1; }
  }

  /* ========== MAIN TERMINAL ========== */
  #terminal {
    display: none;
    height: 100vh;
    width: 100vw;
    padding: 20px 30px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--green-dim) transparent;
  }

  #terminal::-webkit-scrollbar { width: 4px; }
  #terminal::-webkit-scrollbar-track { background: transparent; }
  #terminal::-webkit-scrollbar-thumb { background: var(--green-dim); }

  /* ASCII name banner */
  #banner {
    font-family: 'VT323', monospace;
    font-size: 52px;
    color: var(--white);
    text-shadow:
      0 0 10px var(--green),
      0 0 30px var(--green),
      2px 2px 0 #000;
    letter-spacing: 4px;
    margin-bottom: 10px;
    line-height: 1;
  }

  .hint { color: var(--white); margin-bottom: 18px; font-size: 14px; }
  .hint span { color: var(--green); }

  /* Output area */
  #output { margin-bottom: 6px; }

  .output-block { margin-bottom: 14px; }

  /* Prompt line */
  .prompt-wrap {
    display: flex;
    align-items: center;
    gap: 0;
  }

  .prompt {
    color: var(--green-dim);
    white-space: nowrap;
    user-select: none;
  }

  .prompt .at { color: var(--cyan); }
  .prompt .path { color: var(--yellow); }

  #input-line {
    display: flex;
    align-items: center;
  }

  #cmd-input {
    background: transparent;
    border: none;
    outline: none;
    color: var(--white);
    font-family: 'Share Tech Mono', monospace;
    font-size: 15px;
    flex: 1;
    caret-color: var(--green);
  }

  /* Blinking cursor when idle */
  .blink-cursor {
    display: inline-block;
    width: 9px;
    height: 15px;
    background: var(--green);
    animation: blink 1s step-end infinite;
    vertical-align: middle;
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
  }

  /* Command echo */
  .cmd-echo {
    color: var(--white);
  }
  .cmd-echo .prompt-echo { color: var(--green-dim); }
  .cmd-echo .prompt-echo .at { color: var(--cyan); }
  .cmd-echo .prompt-echo .path { color: var(--yellow); }

  /* Help table */
  .help-grid { margin-top: 6px; }
  .help-row { display: flex; gap: 8px; margin-bottom: 2px; }
  .help-cmd { color: var(--green); min-width: 130px; }
  .help-desc { color: var(--white); }

  /* About poem */
  .poem { color: var(--white); line-height: 2; }
  .poem .hi { color: var(--green); }
  .poem .hn { color: var(--cyan); }
  .poem .hr { color: var(--red); }
  .poem .hy { color: var(--yellow); }
  .poem .hp { color: var(--pink); }

  /* Skills table */
  .skills-table {
    border-collapse: collapse;
    margin-top: 10px;
  }
  .skills-table td {
    border: 1px solid var(--green-dim);
    padding: 6px 18px;
    text-align: center;
    color: var(--green);
    min-width: 130px;
  }

  /* Contact */
  .contact-item { margin-bottom: 8px; color: var(--white); }
  .contact-label { color: var(--pink); }
  .contact-val { color: var(--white); }
  .contact-note { color: var(--white); margin-top: 12px; font-size: 13px; }
  .contact-note span { color: var(--pink); }

  /* Projects */
  .project-name { color: var(--yellow); font-size: 16px; margin-bottom: 4px; }
  .project-desc { color: var(--white); margin-bottom: 8px; }
  .project-bullet { color: var(--white); margin-left: 2px; margin-bottom: 2px; }
  .project-bullet::before { content: '- '; }
  .project-links { margin-top: 8px; }
  .project-links span { color: var(--pink); margin-right: 16px; cursor: pointer; }
  .project-links span:hover { text-decoration: underline; }
  .project-sep { color: var(--green-dim); margin: 16px 0 12px; }
  .hl-green { color: var(--green); }
  .hl-yellow { color: var(--yellow); }
  .hl-cyan { color: var(--cyan); }
  .hl-pink { color: var(--pink); }

  /* Links */
  .links-list { color: var(--white); line-height: 2; }
  .links-note { color: var(--white); margin-top: 10px; font-size: 13px; }
  .links-note span { color: var(--pink); }

  /* Not found */
  .not-found { color: var(--red); }

  /* Surprise ASCII art */
  .surprise-art {
    color: var(--green);
    font-size: 8px;
    line-height: 1.1;
    white-space: pre;
    font-family: monospace;
  }

  /* section label */
  .section-label { color: var(--white); margin-bottom: 8px; }

  /* flicker animation on load */
  @keyframes flicker {
    0%, 100% { opacity: 1; }
    92% { opacity: 1; }
    93% { opacity: 0.4; }
    94% { opacity: 1; }
    96% { opacity: 0.6; }
    97% { opacity: 1; }
  }

  #terminal { animation: flicker 8s infinite; }
</style>
</head>
<body>

<!-- BOOT SCREEN -->
<div id="boot-screen">
  <div id="boot-lines"></div>
</div>

<!-- MAIN TERMINAL -->
<div id="terminal">
  <div id="banner">SATYAVRAT YADAV</div>
  <div class="hint">Type <span>help</span> for a list of commands.</div>
  <div id="output"></div>
  <div id="input-line">
    <span class="prompt"><span class="at">@satyavrat</span>/<span class="path">portfolio</span>:$&nbsp;</span>
    <input id="cmd-input" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" autofocus>
  </div>
</div>

<script>
// ===================== BOOT SEQUENCE =====================
const bootMessages = [
  { text: 'BIOS v2.4.1 â€” Initializing hardware...', cls: 'boot-info', delay: 0 },
  { text: 'CPU: SatyavratCoreâ„¢ @ 4.2GHz (8 cores) â€” OK', cls: 'boot-ok', delay: 80 },
  { text: 'RAM: 16384MB DDR5 â€” OK', cls: 'boot-ok', delay: 140 },
  { text: 'NVMe SSD: 1TB â€” OK', cls: 'boot-ok', delay: 200 },
  { text: 'Loading kernel 6.1.0-satyavrat-portfolio...', cls: 'boot-info', delay: 320 },
  { text: '[    0.000000] Linux version 6.1.0 (gcc 12.2.0)', cls: 'boot-info', delay: 420 },
  { text: '[    0.002341] ACPI: IRQ0 used by override.', cls: 'boot-info', delay: 480 },
  { text: '[    0.018932] PCI: Using configuration type 1 for base access', cls: 'boot-info', delay: 530 },
  { text: '[    0.041120] clocksource: tsc-early: mask: 0xffffffffffffffff', cls: 'boot-info', delay: 580 },
  { text: '[    0.055440] NET: Registered PF_INET6 protocol family', cls: 'boot-info', delay: 620 },
  { text: '[    0.072111] Bluetooth: Core ver 2.22 initialized', cls: 'boot-info', delay: 660 },
  { text: '[    0.088000] Loading modules...', cls: 'boot-info', delay: 720 },
  { text: '[  OK  ] Started D-Bus System Message Bus.', cls: 'boot-ok', delay: 800 },
  { text: '[  OK  ] Started Network Manager.', cls: 'boot-ok', delay: 860 },
  { text: '[  OK  ] Started OpenSSH server daemon.', cls: 'boot-ok', delay: 920 },
  { text: '[  OK  ] Reached target Multi-User System.', cls: 'boot-ok', delay: 980 },
  { text: '[  OK  ] Mounted /dev/portfolio on /srv.', cls: 'boot-ok', delay: 1040 },
  { text: '[ WARN ] Low caffeine levels detected in developer bloodstream.', cls: 'boot-warn', delay: 1120 },
  { text: '[  OK  ] Caffeine injection module loaded.', cls: 'boot-ok', delay: 1200 },
  { text: '[  OK  ] Loaded skills: NodeJS, TypeScript, AWS, Docker, Redis...', cls: 'boot-ok', delay: 1280 },
  { text: '[  OK  ] Personality module: funny_guy.so initialized.', cls: 'boot-ok', delay: 1360 },
  { text: '[  OK  ] Started portfolio.service â€” Satyavrat Yadav Portfolio v1.0', cls: 'boot-ok', delay: 1440 },
  { text: '', cls: '', delay: 1540 },
  { text: 'Ubuntu 22.04.3 LTS @satyavrat/portfolio tty1', cls: 'boot-info', delay: 1620 },
  { text: '', cls: '', delay: 1680 },
  { text: 'Starting interactive session...', cls: 'boot-info', delay: 1740 },
];

const bootContainer = document.getElementById('boot-lines');

bootMessages.forEach((msg, i) => {
  setTimeout(() => {
    const span = document.createElement('div');
    span.className = 'boot-line ' + (msg.cls || '');
    span.textContent = msg.text;
    bootContainer.appendChild(span);
    bootContainer.scrollTop = bootContainer.scrollHeight;

    if (i === bootMessages.length - 1) {
      setTimeout(showTerminal, 700);
    }
  }, msg.delay);
});

function showTerminal() {
  const boot = document.getElementById('boot-screen');
  boot.style.transition = 'opacity 0.5s';
  boot.style.opacity = '0';
  setTimeout(() => {
    boot.style.display = 'none';
    const term = document.getElementById('terminal');
    term.style.display = 'block';
    document.getElementById('cmd-input').focus();
  }, 500);
}

// ===================== TERMINAL LOGIC =====================
const output = document.getElementById('output');
const cmdInput = document.getElementById('cmd-input');

const links = {
  github: 'https://github.com/Veritas-0312',
  linkedin: 'https://www.linkedin.com/in/satyavrat-yadav/',
  X: 'https://x.com/Veritas_03',
  // hashnode: 'https://hashnode.com/@satyavrat',
  'project-1': 'https://github.com/Veritas-0312/Aegismap',
  'project-2': 'https://github.com/Veritas-0312/Phishnet',
};

const commands = {
  help() {
    return `<div class="section-label">commands:</div>
<div class="help-grid">
  <div class="help-row"><span class="help-cmd">help</span><span class="help-desc">- list all available commands</span></div>
  <div class="help-row"><span class="help-cmd">about</span><span class="help-desc">- introduction about me</span></div>
  <div class="help-row"><span class="help-cmd">skills</span><span class="help-desc">- list of technologies I have worked with</span></div>
  <div class="help-row"><span class="help-cmd">contact</span><span class="help-desc">- contact information</span></div>
  <div class="help-row"><span class="help-cmd">projects</span><span class="help-desc">- list of projects</span></div>
  <div class="help-row"><span class="help-cmd">clear</span><span class="help-desc">- clear the terminal</span></div>
  <div class="help-row"><span class="help-cmd">links</span><span class="help-desc">- list all the links</span></div>
  <div class="help-row"><span class="help-cmd">open [link-name]</span><span class="help-desc">- open a link in a new tab</span></div>
  <div class="help-row"><span class="help-cmd">surprise</span><span class="help-desc">- surprise yourself</span></div>
</div>`;
  },

  about() {
    return `<div class="poem">
In the shadows of the web, I reign with precision<br>
My name is <span class="hi">Satyavrat</span>, and hacking is my mission<br>
Armed with <span class="hn">eJPT</span> by iNE, a warrior forged in flame<br>
<span class="hr">PG Diploma</span> from CDAC Thiruvananthapuram â€” security is my name<br>
<br>
In <span class="hy">Cyber Security and Forensics</span>, I hunt what others miss<br>
<span class="hn">Network</span> and <span class="hr">Web Application Security</span> â€” my expertise, my bliss<br>
With <span class="hy">BurpSuite</span>, <span class="hi">Metasploit</span>, <span class="hn">Wireshark</span> and <span class="hr">Nmap</span><br>
No attack surface hidden, no system off the map<br>
<br>
<span class="hn">Python</span>, <span class="hr">JavaScript</span>, <span class="hy">C/C++</span> â€” I speak the machine's tongue<br>
And <span class="hi">GoLang</span>? Still learning, but the battle's just begun<br>
From <span class="hn">DevOps</span> to <span class="hr">Blockchain</span>, <span class="hy">AI</span> to the cloud<br>
A passionate learner â€” curious, relentless, proud<br>
<br>
<span class="hi">Aegismap</span> wields AI to break web apps apart<br>
And <span class="hn">Phishnet</span> dissects phishing emails â€” dark art<br>
I don't just find the flaws â€” I build what defends<br>
The hacker. The builder. The story never ends.<br>
</div>`;
  },

  skills() {
    const skills = [
      ['Linux', 'Windows', 'Shell Scripting', 'Bash'],
      ['MySQL', 'Javascript', 'Python', 'C/C++'],
      ['Metasploit', 'Wireshark', 'Nikto', 'Nessus'],
      ['BurpSuite', 'OWASP ZAP', 'Caido', 'Nmap'],
      ['SAST', 'DAST', 'Computer Networking', 'SOC/SIEM'],
    ];
    let html = '<table class="skills-table">';
    skills.forEach(row => {
      html += '<tr>' + row.map(s => `<td>${s}</td>`).join('') + '</tr>';
    });
    html += '</table>';
    return html;
  },

  contact() {
    return `<div class="contact-item"><span class="contact-label">[email]</span>: <span class="contact-val">satyavratyadav2000@gmail.com</span></div>
<div class="contact-item"><span class="contact-label">[linkedin]</span>: <span class="contact-val">https://www.linkedin.com/in/satyavrat-yadav/</span></div>
<div class="contact-item"><span class="contact-label">[X]</span>: <span class="contact-val">https://x.com/Veritas_03</span></div>
<div class="contact-item"><span class="contact-label">[github]</span>: <span class="contact-val">https://github.com/Veritas-0312</span></div>
<div class="contact-note">Open link by typing "open <span>[link-name]</span>" for example "open github"</div>`;
  },

  projects() {
    return `<div class="output-block">
  <div class="project-name">Phishnet</div>
  <div class="project-desc">An AI-powered email analyzer that combines heuristic and LLM-based detection to identify and explain malicious phishing emails, built for security awareness training.</div>
  <div class="project-bullet">Built a <span class="hl-green">Python</span>-based engine to generate context-aware phishing scenarios including <span class="hl-yellow">BEC</span> and <span class="hl-yellow">credential harvesting</span> using LLMs, automating red-team social engineering tests.</div>
  <div class="project-bullet">Engineered a hybrid threat detection system combining <span class="hl-cyan">heuristic analysis</span> (urgency signals, link reputation) with <span class="hl-cyan">AI-based reasoning</span> to identify and explain malicious emails.</div>
  <div class="project-bullet">Developed and containerized a full-stack security application using <span class="hl-pink">Docker</span> and <span class="hl-green">FastAPI</span>, enabling rapid deployment for internal security awareness training.</div>
  <div class="project-links">
    <span onclick="openLink('github-phishnet')">[github-phishnet]</span>
  </div>
</div>
<div class="project-sep">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</div>
<div class="output-block">
  <div class="project-name">Aegismap</div>
  <div class="project-desc">An AI-driven reconnaissance tool that automates attack surface mapping for Single Page Applications (SPAs), leveraging LLMs and vector search to surface hidden endpoints and secrets.</div>
  <div class="project-bullet">Developed an automated attack surface mapper for <span class="hl-yellow">SPAs</span> using <span class="hl-green">Python</span> and <span class="hl-green">Playwright</span>, streamlining reconnaissance for web application security testing.</div>
  <div class="project-bullet">Integrated <span class="hl-cyan">Large Language Models</span> to perform semantic static analysis on 1000+ lines of JavaScript, successfully identifying obfuscated <span class="hl-pink">API keys</span> and undocumented developer endpoints.</div>
  <div class="project-bullet">Implemented <span class="hl-cyan">Vector Search</span> using <span class="hl-yellow">FAISS</span> to cluster API endpoints by semantic similarity, reducing manual review time by grouping redundant routes and highlighting <span class="hl-pink">IDOR candidates</span>.</div>
  <div class="project-links">
    <span onclick="openLink('github-aegismap')">[github-aegismap]</span>
  </div>
</div>
<div class="project-sep">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</div>
<div class="contact-note">Open link by typing "open <span class="hl-pink">[link-name]</span>" for example "open github-phishnet"</div>`;
  },

  links() {
    const names = Object.keys(links);
    return `<div class="links-list">${names.join('\n').split('\n').map(n => n).join('<br>')}</div>
<div class="links-note"><br>Type "open <span>[link-name]</span>" to open a link in a new tab</div>`;
  },
  surprise() {
    const art = `
         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
        â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
        â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
        â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
         â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• 
                                             
        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
        â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   
        â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
        â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
        â•šâ•â•     â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•  
    `;
    return `<pre class="surprise-art">${art}</pre><br><div style="color:var(--yellow)">âœ¨ "First, solve the problem. Then, write the code." â€” John Johnson</div><br><div style="color:var(--cyan)">ğŸ‘¾ You found the easter egg! Now go hire me. ğŸ˜„</div>`;
  },

  clear() {
    output.innerHTML = '';
    return null;
  },
};

function openLink(name) {
  const url = links[name];
  if (url) {
    window.open(url, '_blank');
  }
}

function promptHTML() {
  return `<span class="prompt"><span class="at">@satyavrat</span>/<span class="path">portfolio</span>:$&nbsp;</span>`;
}

function processCommand(raw) {
  const trimmed = raw.trim().toLowerCase();
  const parts = trimmed.split(/\s+/);
  const cmd = parts[0];
  const args = parts.slice(1);

  // Echo the command
  const echoDiv = document.createElement('div');
  echoDiv.className = 'cmd-echo';
  echoDiv.innerHTML = `${promptHTML()}<span style="color:var(--white)">${escapeHtml(raw.trim())}</span>`;
  output.appendChild(echoDiv);

  if (!trimmed) {
    scrollDown();
    return;
  }

  let resultHTML = '';

  if (cmd === 'open') {
    const linkName = args[0];
    if (!linkName) {
      resultHTML = `<span class="not-found">Usage: open [link-name]. Type "links" to see available links.</span>`;
    } else if (links[linkName]) {
      window.open(links[linkName], '_blank');
      resultHTML = `<span style="color:var(--green)">Opening ${linkName}...</span>`;
    } else {
      resultHTML = `<span class="not-found">Link "${linkName}" not found. Type "links" to see available links.</span>`;
    }
  } else if (commands[cmd]) {
    const result = commands[cmd]();
    if (result === null) { scrollDown(); return; }
    resultHTML = result;
  } else {
    resultHTML = `<span class="not-found">Command not found: ${escapeHtml(cmd)}. Type "help" for available commands.</span>`;
  }

  const resultDiv = document.createElement('div');
  resultDiv.className = 'output-block';
  resultDiv.innerHTML = resultHTML;
  output.appendChild(resultDiv);
  scrollDown();
}

function escapeHtml(str) {
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function scrollDown() {
  const term = document.getElementById('terminal');
  term.scrollTop = term.scrollHeight;
}

// History
let history = [];
let histIdx = -1;

cmdInput.addEventListener('keydown', e => {
  if (e.key === 'Enter') {
    const val = cmdInput.value;
    if (val.trim()) {
      history.unshift(val);
      histIdx = -1;
    }
    processCommand(val);
    cmdInput.value = '';
    e.preventDefault();
  } else if (e.key === 'ArrowUp') {
    if (histIdx < history.length - 1) {
      histIdx++;
      cmdInput.value = history[histIdx];
    }
    e.preventDefault();
  } else if (e.key === 'ArrowDown') {
    if (histIdx > 0) {
      histIdx--;
      cmdInput.value = history[histIdx];
    } else {
      histIdx = -1;
      cmdInput.value = '';
    }
    e.preventDefault();
  }
});

// Keep focus on input
document.getElementById('terminal').addEventListener('click', () => {
  cmdInput.focus();
});
</script>
</body>
</html>